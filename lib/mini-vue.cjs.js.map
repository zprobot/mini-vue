{"version":3,"file":"mini-vue.cjs.js","sources":["../src/runtime-core/vnode.ts","../src/shared/index.ts","../src/runtime-core/component.ts","../src/runtime-core/renderer.ts","../src/runtime-core/createApp.ts","../src/runtime-core/h.ts"],"sourcesContent":["export function createVNode(type, props?, children?) {\r\n\r\n    const vnode = {\r\n        type,\r\n        props,\r\n        children\r\n    }\r\n    return vnode\r\n}","export const extend = Object.assign\r\nexport const isObject = (val) => {\r\n    return val !== null && typeof val === 'object'\r\n}\r\nexport const hadChange = (oldVal, newVal) => {\r\n    return !Object.is(oldVal, newVal)\r\n}","export function createComponentInstance(vnode: any) {\r\n    const component = {\r\n        vnode,\r\n        type: vnode.type\r\n    }\r\n    return component\r\n}\r\nexport function setupComponent(instance) {\r\n    // initprops\r\n    // initSlots\r\n    setupStatefulComponent(instance)\r\n}\r\n\r\nfunction setupStatefulComponent(instance: any) {\r\n    const Component = instance.type\r\n    const {setup} = Component\r\n    if(setup){\r\n        const setupResult = setup()\r\n        handleSetupResult(instance, setupResult)\r\n    }\r\n}\r\nfunction handleSetupResult(instance:any, setupResult: any) {\r\n    // function \r\n    // obj\r\n    if(typeof setupResult === 'object') {\r\n        instance.setupState = setupResult\r\n    }\r\n    finishComponentSetup(instance)\r\n}\r\n\r\nfunction finishComponentSetup(instance: any) {\r\n    const Component = instance.type\r\n    if(Component.render) {\r\n        instance.render = Component.render\r\n    }\r\n}\r\n\r\n","import { isObject } from \"../shared\"\r\nimport { createComponentInstance, setupComponent } from \"./component\"\r\n\r\nexport function render(vnode, container) {\r\n    patch(vnode, container)\r\n}\r\n\r\nfunction patch(vnode, container) {\r\n    // 处理组件\r\n    if(typeof vnode.type === 'string') {\r\n        processElement(vnode, container)\r\n    } else if(isObject(vnode.type)) {\r\n        processComponent(vnode, container)\r\n    }\r\n}\r\nfunction processElement(vnode: any, container: any) {\r\n    mountElement(vnode, container)\r\n}\r\nfunction mountElement(vnode: any, container: any) {\r\n    const {type, props, children} = vnode\r\n    const el = document.createElement(type)\r\n    // children\r\n    if(typeof children === 'string') {\r\n        el.textContent = children\r\n    } else if (Array.isArray(children)) {\r\n        mountChildren(vnode,el)\r\n    }\r\n    for(const key of props) {\r\n        el.setAttribute(key,props[key])\r\n    }\r\n    container.append(el)\r\n}\r\nfunction mountChildren(vnode,container) {\r\n    vnode.children.forEach(v=>patch(v,container))\r\n}\r\nfunction processComponent(vnode: any, container: any) {\r\n    mountComponent(vnode, container)\r\n    \r\n}\r\nfunction mountComponent(vnode: any,container: any) {\r\n    const instance = createComponentInstance(vnode)\r\n    setupComponent(instance)\r\n    setupRenderEffect(instance, container)\r\n}\r\n\r\n\r\n\r\nfunction setupRenderEffect(instance: any, container:any) {\r\n    const subTree = instance.render()\r\n    // vnode -> patch\r\n    // vnode -> element -> mountElement\r\n    patch(subTree,container)\r\n}\r\n\r\n\r\n","import { createVNode } from \"./vnode\"\r\nimport { render } from \"./renderer\"\r\nexport function createApp(rootComponent) {\r\n    return {\r\n        mount(rootContainer) {\r\n            const vnode = createVNode(rootComponent)\r\n            render(vnode, rootContainer)\r\n        }\r\n    }\r\n}\r\n","import { createVNode } from \"./vnode\";\r\nexport function h(type, props?, children?) {\r\n    return createVNode(type,props,children)\r\n}"],"names":[],"mappings":"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"}